

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Guide &mdash; python-pagerduty 5.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=ce74c6a2"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PDPYRAS Migration Guide" href="pdpyras_migration_guide.html" />
    <link rel="prev" title="Changelog" href="changelog.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            python-pagerduty
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-interface">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-non-us-service-regions">Using Non-US Service Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-from-header">The From header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performing-an-oauth-exchange-to-obtain-an-access-token">Performing an OAuth Exchange to Obtain an Access Token</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performing-oauth-token-refresh-automatically">Performing OAuth Token Refresh Automatically</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage-examples">Basic Usage Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rest-api-v2">REST API v2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#events-api-v2">Events API v2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#client-classes">Client Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generic-client-features">Generic Client Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#urls">URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-parameters">Query Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requests-and-responses">Requests and Responses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-types">Data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resource-schemas">Resource Schemas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#entity-wrapping">Entity Wrapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#identifying-wrapped-entity-endpoints">Identifying Wrapped-entity Endpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wrapped-entity-aware-functions">Wrapped-entity-aware Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-cases">Special Cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pagination">Pagination</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#retrieving-large-historical-datasets">Retrieving Large Historical Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-standard-pagination-styles">Non-Standard Pagination Styles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-and-completeness-of-results">Performance and Completeness of Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-creating-or-deleting-while-paginating">Updating, creating or deleting while paginating</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multi-updating">Multi-updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-proxy-server">Using a Proxy Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#http-retry-configuration">HTTP Retry Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#default-behavior">Default Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exponential-cooldown">Exponential Cooldown</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-retry-behavior">Configuring Retry Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pdpyras_migration_guide.html">PDPYRAS Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_reference.html">Module Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contribution Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">python-pagerduty</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">User Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/user_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-guide">
<span id="id1"></span><h1>User Guide<a class="headerlink" href="#user-guide" title="Link to this heading"></a></h1>
<p>This is a topical guide to general API client usage. <a class="reference internal" href="module_reference.html#module-reference"><span class="std std-ref">Module Reference</span></a>
has in-depth documentation on client classes and methods.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>This library is available on the Python Package Index as <a class="reference external" href="https://pypi.org/project/pagerduty/">pagerduty</a>, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pagerduty
</pre></div>
</div>
</section>
<section id="command-line-interface">
<h2>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Link to this heading"></a></h2>
<p>This package also includes a basic CLI for PagerDuty Events API V2. For
example, to trigger an incident:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pagerduty<span class="w"> </span>trigger<span class="w"> </span>-k<span class="w"> </span><span class="nv">$ROUTING_KEY</span><span class="w"> </span>--description<span class="w"> </span><span class="s2">&quot;Network latency is high&quot;</span>
</pre></div>
</div>
<p>For more details, use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> flag to display the script’s helptext.</p>
</section>
<section id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Link to this heading"></a></h2>
<p>The first step is to construct a client object. The first argument to the
constructor is the secret to use for accessing the API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pagerduty</span>

<span class="c1"># REST API v2:</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">)</span>

<span class="c1"># REST API v2 with an OAuth2 access token (both are equivalent)</span>
<span class="n">client_oauth</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">OAUTH_TOKEN</span><span class="p">,</span> <span class="n">auth_type</span><span class="o">=</span><span class="s1">&#39;oauth2&#39;</span><span class="p">)</span>
<span class="n">client_oauth</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">OAUTH_TOKEN</span><span class="p">,</span> <span class="n">auth_type</span><span class="o">=</span><span class="s1">&#39;bearer&#39;</span><span class="p">)</span>

<span class="c1"># Events API v2, including change events:</span>
<span class="n">events_client</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">EventsApiV2Client</span><span class="p">(</span><span class="n">ROUTING_KEY</span><span class="p">)</span>
</pre></div>
</div>
<p>Session objects, being descendants of <a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>, can also be used as
context managers. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">do_application</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
<section id="using-non-us-service-regions">
<h3>Using Non-US Service Regions<a class="headerlink" href="#using-non-us-service-regions" title="Link to this heading"></a></h3>
<p>If your PagerDuty account is in the EU or other service region outside the US,
set the <code class="docutils literal notranslate"><span class="pre">url</span></code> attribute according to the documented <a class="reference external" href="https://support.pagerduty.com/docs/service-regions#api-access-urls">API Access URLs</a>, i.e.
for the EU:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># REST API</span>
<span class="n">client</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.eu.pagerduty.com&#39;</span>
<span class="c1"># Events API:</span>
<span class="n">events_client</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://events.eu.pagerduty.com&#39;</span>
<span class="c1"># Slack Integration &quot;Connections&quot; API (and likewise for other</span>
<span class="c1"># APIs that use apps.pagerduty.com and/or some unique base path):</span>
<span class="n">slack_integration_client</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://apps.eu.pagerduty.com/integration-slack&#39;</span>
</pre></div>
</div>
</section>
<section id="the-from-header">
<h3>The From header<a class="headerlink" href="#the-from-header" title="Link to this heading"></a></h3>
<p>This request header can be set for all requests using the attribute
<a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.default_from" title="pagerduty.RestApiV2Client.default_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.default_from</span></code></a> property, either directly or
through the <code class="docutils literal notranslate"><span class="pre">default_from</span></code> keyword argument when instantiating the client
object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">,</span> <span class="n">default_from</span><span class="o">=</span><span class="s2">&quot;admin@example.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If using an account-level API key, created by an administrator via the “API
Access Keys” page in the “Integrations” menu, a <code class="docutils literal notranslate"><span class="pre">From</span></code> header must be set in
requests to certain API endpoints, e.g. acknowledging or resolving incidents.
Its value must be the email address of a valid PagerDuty user.</p>
<p>Otherwise, if using a user’s API key (created under “API Access” in the “User
Settings” tab of the user’s profile), the user will be derived from the key
itself and it is not necessary to set <code class="docutils literal notranslate"><span class="pre">default_from</span></code> or supply a <code class="docutils literal notranslate"><span class="pre">From</span></code>
header.</p>
<p>If the source of the API key is unknown, the value of the client object’s
property <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.api_key_access" title="pagerduty.RestApiV2Client.api_key_access"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.api_key_access</span></code></a> can be used. It will
be <code class="docutils literal notranslate"><span class="pre">account</span></code> if its API secret is an account-level API key, and it will be
<code class="docutils literal notranslate"><span class="pre">user</span></code> for a user-level API key.</p>
</section>
<section id="performing-an-oauth-exchange-to-obtain-an-access-token">
<h3>Performing an OAuth Exchange to Obtain an Access Token<a class="headerlink" href="#performing-an-oauth-exchange-to-obtain-an-access-token" title="Link to this heading"></a></h3>
<p>The client class <a class="reference internal" href="module_reference.html#pagerduty.OAuthTokenClient" title="pagerduty.OAuthTokenClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.OAuthTokenClient</span></code></a> provides methods
implementing the OAuth exchange requests described in <a class="reference external" href="https://developer.pagerduty.com/docs/user-oauth-token-via-code-grant">Obtaining a User OAuth
Token via Code Grant</a> and
<a class="reference external" href="https://developer.pagerduty.com/docs/app-oauth-token">Obtaining an App OAuth Token</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">token_client</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">OAuthTokenClient</span><span class="p">(</span><span class="n">client_secret</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
</pre></div>
</div>
<p>To generate the URL that the user must visit to authorize the application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># With a client object:</span>
<span class="n">authorize_url</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">authorize_url</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">)</span>

<span class="c1"># Without a client object:</span>
<span class="n">authorize_url</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">OAuthTokenClient</span><span class="o">.</span><span class="n">get_authorize_url</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">)</span>

<span class="c1"># For PKCE:</span>
<span class="n">code_verifier</span><span class="p">,</span> <span class="n">code_challenge</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">generate_s256_pkce_params</span><span class="p">()</span>
<span class="n">authorize_url</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">get_pkce_authorize_url</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">,</span> <span class="n">code_challenge</span><span class="p">)</span>
<span class="c1"># code_verifier must be securely and temporarily stored for the final step of authorization</span>
</pre></div>
</div>
<p>In all cases, the application must provide a redirect URI at which to receive
the authorization code parameter. Once the user visits, has authorized the
application and is redirected back to the application at the redirect URI, the
<code class="docutils literal notranslate"><span class="pre">code</span></code> parameter appended to it will contain the authorization code. The code
it contains can then be exchanged for an access token in one of the following ways:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># via code grant:</span>
<span class="n">auth_response</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">get_new_token_from_code</span><span class="p">(</span><span class="n">auth_code</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span>
    <span class="n">redirect_uri</span><span class="p">)</span>

<span class="c1"># via PKCE:</span>
<span class="n">auth_response</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">get_new_token_from_code_with_pkce</span><span class="p">(</span><span class="n">auth_code</span><span class="p">,</span>
    <span class="n">scope</span><span class="p">,</span> <span class="n">redirect_uri</span><span class="p">,</span> <span class="n">code_verifier</span><span class="p">)</span>

<span class="c1"># the dictionary it returns in either case can then be used as follows:</span>
<span class="n">access_token</span> <span class="o">=</span> <span class="n">auth_response</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
<span class="n">refresh_token</span> <span class="o">=</span> <span class="n">auth_response</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="performing-oauth-token-refresh-automatically">
<h3>Performing OAuth Token Refresh Automatically<a class="headerlink" href="#performing-oauth-token-refresh-automatically" title="Link to this heading"></a></h3>
<p>As of version 3.0.0, the OAuth response dictionary returned by token-getting
methods of <a class="reference internal" href="module_reference.html#pagerduty.OAuthTokenClient" title="pagerduty.OAuthTokenClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.OAuthTokenClient</span></code></a> will include a property
<code class="docutils literal notranslate"><span class="pre">expiration_date</span></code> containing a string that is an ISO8601-formatted date/time
indicating when the included token will expire. Assuming that your application
securely stores this string value in addition to <code class="docutils literal notranslate"><span class="pre">access_token</span></code> and
<code class="docutils literal notranslate"><span class="pre">refresh_token</span></code>, and has the means to retrieve these values, they can be used
to call <a class="reference internal" href="module_reference.html#pagerduty.OAuthTokenClient.refresh_client" title="pagerduty.OAuthTokenClient.refresh_client"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.OAuthTokenClient.refresh_client</span></code></a>, which instantiates a
new <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client" title="pagerduty.RestApiV2Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client</span></code></a> and automatically refreshes the access
token as necessary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assume the calling application implements methods securely_get_values and</span>
<span class="c1"># securely_store_values to recall and store secrets used for API access:</span>
<span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">expiration_date</span> <span class="o">=</span> <span class="n">securely_get_values</span><span class="p">()</span>
<span class="n">rest_client</span><span class="p">,</span> <span class="n">auth_response</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">refresh_client</span><span class="p">(</span>
    <span class="n">access_token</span><span class="p">,</span>
    <span class="n">refresh_token</span><span class="p">,</span>
    <span class="n">expiration_date</span>
<span class="p">)</span>
<span class="c1"># If auth_response == None, the token was not refreshed and does not need</span>
<span class="c1"># to be updated; otherwise it will be similar to the value returned by</span>
<span class="c1"># other token-getting methods:</span>
<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">auth_response</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">securely_store_values</span><span class="p">(</span>
        <span class="n">access_token</span> <span class="o">=</span> <span class="n">auth_response</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">],</span>
        <span class="n">refresh_token</span> <span class="o">=</span> <span class="n">auth_response</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">],</span>
        <span class="n">expiration_date</span> <span class="o">=</span> <span class="n">auth_response</span><span class="p">[</span><span class="s1">&#39;expiration_date&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Note, the current default behavior of <code class="xref py py-class docutils literal notranslate"><span class="pre">OAuthTokenClient</span></code> is to refresh
the token if it is going to expire less than 24 hours in the future. This
“buffer time” (expressed as a positive integer number of seconds in the future)
can be controlled by setting the property
<a class="reference internal" href="module_reference.html#pagerduty.OAuthTokenClient.early_refresh_buffer" title="pagerduty.OAuthTokenClient.early_refresh_buffer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.OAuthTokenClient.early_refresh_buffer</span></code></a>.</p>
<p>As of this writing, the method only supports returning objects of class
:class`pagerduty.RestApiV2Client`. Refreshing the token for other use cases
will have to be done separately from instantiation of the client object. For
example, to refresh the token if it is less than 24 hours before expiring,
before using the token:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stored values recalled: expiration_date, access_token, refresh_token</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pagerduty.common</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime_to_relative_seconds</span> <span class="k">as</span> <span class="n">rel_seconds</span>
<span class="k">if</span> <span class="n">rel_seconds</span><span class="p">(</span><span class="n">expiration_date</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">86400</span><span class="p">:</span>
    <span class="n">auth</span> <span class="o">=</span> <span class="n">token_client</span><span class="o">.</span><span class="n">get_refreshed_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">)</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">auth</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
    <span class="n">refresh_token</span> <span class="o">=</span> <span class="n">auth</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span>
    <span class="n">expiration_date</span> <span class="o">=</span> <span class="n">auth</span><span class="p">[</span><span class="s1">&#39;expiration_date&#39;</span><span class="p">]</span>
<span class="c1"># API clients can now be constructed with access_token;</span>
<span class="c1"># stored values of refresh_token and expiration_date must be updated</span>
</pre></div>
</div>
</section>
</section>
<section id="basic-usage-examples">
<h2>Basic Usage Examples<a class="headerlink" href="#basic-usage-examples" title="Link to this heading"></a></h2>
<section id="rest-api-v2">
<h3>REST API v2<a class="headerlink" href="#rest-api-v2" title="Link to this heading"></a></h3>
<p><strong>Making a request and decoding the response:</strong> obtaining a resource’s contents
and having them represented as a dictionary object using three different methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using get:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

<span class="c1"># Using jget (return the full body after decoding):</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">jget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

<span class="c1"># Using rget (return the response entity after unwrapping):</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>

<span class="c1"># &gt;&gt;&gt; user</span>
<span class="c1"># {&quot;type&quot;: &quot;user&quot;, &quot;email&quot;: &quot;user@example.com&quot;, ... }</span>
</pre></div>
</div>
<p><strong>Using pagination:</strong> <code class="docutils literal notranslate"><span class="pre">iter_all</span></code>, <code class="docutils literal notranslate"><span class="pre">iter_cursor</span></code>, <code class="docutils literal notranslate"><span class="pre">list_all</span></code> and
<code class="docutils literal notranslate"><span class="pre">dict_all</span></code> can be used to obtain results from a resource collection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print each user&#39;s email address and name:</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Pagination with query parameters:</strong> set the <code class="docutils literal notranslate"><span class="pre">params</span></code> keyword argument, which is
converted to URL query parameters by <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a list of all services with &quot;SN&quot; in their name:</span>
<span class="n">services</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span><span class="s1">&#39;services&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">})</span>

<span class="c1"># &gt;&gt;&gt; services</span>
<span class="c1"># [{&#39;type&#39;:&#39;service&#39;, ...}, ...]</span>
</pre></div>
</div>
<p><strong>Searching resource collections:</strong> use <code class="docutils literal notranslate"><span class="pre">find</span></code> to look up a resource (a user,
in this example) exactly matching a string using the <code class="docutils literal notranslate"><span class="pre">query</span></code> parameter on an
index endpoint:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the user with email address &quot;jane@example35.com&quot;</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;jane@example35.com&#39;</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>

<span class="c1"># &gt;&gt;&gt; user</span>
<span class="c1"># {&#39;type&#39;: &#39;user&#39;, &#39;email&#39;: &#39;jane@example35.com&#39;, ...}</span>
</pre></div>
</div>
<p><strong>Getting a count of records:</strong> use <code class="docutils literal notranslate"><span class="pre">get_total</span></code> on any endpoint
that supports classic pagination:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the total number of users in the whole account:</span>
<span class="n">total_users</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_total</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>

<span class="c1"># Get the total number of users on a given team:</span>
<span class="n">total_users_on_team_x</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_total</span><span class="p">(</span>
    <span class="s1">&#39;users&#39;</span><span class="p">,</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;team_ids[]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PGHI789&#39;</span><span class="p">]}</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Updating a resource:</strong> use the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument to set the body of the request:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># &gt;&gt;&gt; user</span>
<span class="c1"># {&#39;self&#39;:&#39;https://api.pagerduty.com/users/PABC123&#39;, &#39;type&#39;: &#39;user&#39;, ...}</span>

<span class="c1"># (1) using put directly:</span>
<span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span>
    <span class="p">}</span>
<span class="p">})</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
    <span class="n">updated_user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

<span class="c1"># (2) using rput:</span>
<span class="c1">#   - The URL argument may also be a resource / resource reference dict</span>
<span class="c1">#   - The json argument doesn&#39;t have to include the &quot;user&quot; wrapper dict</span>
<span class="c1">#   - If an HTTP error is encountered, it will raise an exception</span>
<span class="n">updated_user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>Idempotent create/update:</strong> create a user if one doesn’t already exist based
on the dictionary object <code class="docutils literal notranslate"><span class="pre">user_data</span></code>, using the “email” key/property as the
uniquely identifying attribute, and update it if it exists and differs from
<code class="docutils literal notranslate"><span class="pre">user_data</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;user123@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;User McUserson&#39;</span><span class="p">}</span>
<span class="n">updated_user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="n">user_data</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Using multi-valued set filters:</strong> set the value in the <code class="docutils literal notranslate"><span class="pre">params</span></code> dictionary
at the appropriate key to a list. Square brackets will then be automatically
appended to the names of list-type-value parameters as necessary. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query all open incidents assigned to a user</span>
<span class="n">incidents</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span>
    <span class="s1">&#39;incidents&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
      <span class="c1"># Both of the following parameter names are valid:</span>
      <span class="s1">&#39;user_ids[]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PHIJ789&#39;</span><span class="p">],</span>
      <span class="s1">&#39;statuses&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;triggered&#39;</span><span class="p">,</span> <span class="s1">&#39;acknowledged&#39;</span><span class="p">]</span> <span class="c1"># &quot;[]&quot; will be automatically appended</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="c1"># API calls will look like the following:</span>
<span class="c1"># GET /incidents?user_ids%5B%5D=PHIJ789&amp;statuses%5B%5D=triggered&amp;statuses%5B%5D=acknowledged&amp;offset=0&amp;limit=100</span>
</pre></div>
</div>
<p><strong>Get a list of all incident notes submitted by a team within a time range:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">notes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">iter_incident_notes</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;team_ids&#39;</span><span class="p">:[</span><span class="s1">&#39;PN1T34M&#39;</span><span class="p">],</span>
    <span class="s1">&#39;since&#39;</span><span class="p">:</span> <span class="s1">&#39;2025-01-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;until&#39;</span><span class="p">:</span> <span class="s1">&#39;2025-07-01&#39;</span>
<span class="p">}))</span>

<span class="c1"># &gt;&gt;&gt; notes</span>
<span class="c1"># [{&#39;type&#39;: &#39;annotate_log_entry&#39;, &#39;summary&#39;: &#39;Resolved by reboot&#39; ... }, ... ]</span>
</pre></div>
</div>
<p><strong>Performing multi-update:</strong> for endpoints that support it only, i.e. <code class="docutils literal notranslate"><span class="pre">PUT</span> <span class="pre">/incidents</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Acknowledge all triggered incidents assigned to a user:</span>
<span class="n">incidents</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span>
    <span class="s1">&#39;incidents&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user_ids&#39;</span><span class="p">:[</span><span class="s1">&#39;PHIJ789&#39;</span><span class="p">],</span><span class="s1">&#39;statuses&#39;</span><span class="p">:[</span><span class="s1">&#39;triggered&#39;</span><span class="p">]}</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">incidents</span><span class="p">:</span>
    <span class="n">i</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;acknowledged&#39;</span>
<span class="n">updated_incidents</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="s1">&#39;incidents&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">incidents</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="events-api-v2">
<h3>Events API v2<a class="headerlink" href="#events-api-v2" title="Link to this heading"></a></h3>
<p><strong>Trigger and resolve an alert,</strong> getting its deduplication key from the API, using <a class="reference internal" href="module_reference.html#pagerduty.EventsApiV2Client" title="pagerduty.EventsApiV2Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.EventsApiV2Client</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dedup_key</span> <span class="o">=</span> <span class="n">events_client</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s2">&quot;Server is on fire&quot;</span><span class="p">,</span> <span class="s1">&#39;dusty.old.server.net&#39;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="n">events_client</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">dedup_key</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Trigger an alert and acknowledge it</strong> using a custom deduplication key:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">events_client</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s2">&quot;Server is on fire&quot;</span><span class="p">,</span> <span class="s1">&#39;dusty.old.server.net&#39;</span><span class="p">,</span>
    <span class="n">dedup_key</span><span class="o">=</span><span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="n">events_client</span><span class="o">.</span><span class="n">acknowledge</span><span class="p">(</span><span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Submit a change event</strong> using a <a class="reference internal" href="module_reference.html#pagerduty.EventsApiV2Client" title="pagerduty.EventsApiV2Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.EventsApiV2Client</span></code></a> instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">events_client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="s2">&quot;new build finished at latest HEAD&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;automation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="client-classes">
<h2>Client Classes<a class="headerlink" href="#client-classes" title="Link to this heading"></a></h2>
<p>For each of the APIs documented in the top-level sections of the <a class="reference external" href="https://developer.pagerduty.com/api-reference/e65c5833eeb07-pager-duty-api">API
References</a>
page, this library supports and provides abstraction for the API if it has a
dedicated client class. These classes are documented under
“API Client Classes” in <a class="reference internal" href="module_reference.html#module-reference"><span class="std std-ref">Module Reference</span></a>.</p>
<p>All client classes are based on <a class="reference internal" href="module_reference.html#pagerduty.ApiClient" title="pagerduty.ApiClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.ApiClient</span></code></a> and inherit its
features.</p>
<p>The class <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient" title="pagerduty.RestApiV2BaseClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient</span></code></a> defines abstractions for
features documented under the generic <a class="reference external" href="https://developer.pagerduty.com/docs/rest-api-overview">REST API v2 Overview</a>, and
<a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client" title="pagerduty.RestApiV2Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client</span></code></a> inherits them.</p>
<p>The “Integration” APIs are based loosely on REST API v2, and support several of
the same features and conventions to varying degrees. For this reason, they
also are based on inherit the features of <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient" title="pagerduty.RestApiV2BaseClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient</span></code></a>.</p>
</section>
<section id="generic-client-features">
<h2>Generic Client Features<a class="headerlink" href="#generic-client-features" title="Link to this heading"></a></h2>
<p>Generally, all of the features of <a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a> are available to the user
as they would be if using the Requests Python library directly, since
<a class="reference internal" href="module_reference.html#pagerduty.ApiClient" title="pagerduty.ApiClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.ApiClient</span></code></a> and its subclasses for the REST/Events APIs are
descendants of it.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">put</span></code> and <code class="docutils literal notranslate"><span class="pre">delete</span></code> methods of REST/Events API
client classes are similar to the analogous functions in <a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>.
The arguments they accept are the same and they all return <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>
objects.</p>
<p>Any keyword arguments passed to the <code class="docutils literal notranslate"><span class="pre">j*</span></code> or <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods will be passed
through to the analogous method in <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a>, though in some cases the
arguments (i.e. <code class="docutils literal notranslate"><span class="pre">json</span></code>) are first modified.</p>
<p>For documentation on any generic HTTP client features that are available, refer
to the <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a> documentation.</p>
</section>
<section id="urls">
<h2>URLs<a class="headerlink" href="#urls" title="Link to this heading"></a></h2>
<p>The first argument to most of the client methods is the URL. However, there is
no need to specify a complete API URL. Any path relative to the root of the
API, whether or not it includes a leading slash, is automatically normalized to
a complete API URL.  For instance, one can specify <code class="docutils literal notranslate"><span class="pre">users/PABC123</span></code> or
<code class="docutils literal notranslate"><span class="pre">/users/PABC123</span></code> instead of <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users/PABC123</span></code>.</p>
<p>One can also pass the full URL of an API endpoint and it will still work, i.e.
the <code class="docutils literal notranslate"><span class="pre">self</span></code> property of any object can be used, and there is no need to strip
out the API base URL.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">r*</span></code> and <code class="docutils literal notranslate"><span class="pre">j*</span></code> methods, i.e.  <code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.rget</span></code>,
can also accept a dictionary object representing an API resource or a resource
reference (see: <a class="reference external" href="https://developer.pagerduty.com/docs/resource-references">resource references</a>) in place of a URL, in which case the
value at its <code class="docutils literal notranslate"><span class="pre">self</span></code> key will be used as the request URL.</p>
</section>
<section id="query-parameters">
<h2>Query Parameters<a class="headerlink" href="#query-parameters" title="Link to this heading"></a></h2>
<p>As with <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a>, there is no need to compose the query string (everything
that will follow <code class="docutils literal notranslate"><span class="pre">?</span></code> in the URL). Simply set the <code class="docutils literal notranslate"><span class="pre">params</span></code> keyword argument
to a dictionary, and each of the key/value pairs will be serialized to the
query string in the final URL of the request:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_dan</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;Dan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;offset&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">})</span>
<span class="c1"># GET https://api.pagerduty.com/users?query=Dan&amp;limit=1&amp;offset=0</span>
</pre></div>
</div>
<p>To specify a multi-value parameter, i.e. <code class="docutils literal notranslate"><span class="pre">include[]</span></code>, set the argument to a
list. If a list is given, and the key name does not end with <code class="docutils literal notranslate"><span class="pre">[]</span></code> (which is
required for all such multi-valued parameters in REST API v2), then <code class="docutils literal notranslate"><span class="pre">[]</span></code> will
be automatically appended to the parameter name. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># If there are 82 services with name matching &quot;foo&quot; this will return all of</span>
<span class="c1"># them as a list:</span>
<span class="n">foo_services</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span><span class="s1">&#39;services&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;include&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;escalation_policies&#39;</span><span class="p">,</span> <span class="s1">&#39;teams&#39;</span><span class="p">],</span>
    <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
<span class="p">})</span>
<span class="c1"># GET https://api.pagerduty.com/services?query=foo&amp;include%5B%5D=escalation_policies&amp;include%5B%5D=teams&amp;limit=50&amp;offset=0</span>
<span class="c1"># GET https://api.pagerduty.com/services?query=foo&amp;include%5B%5D=escalation_policies&amp;include%5B%5D=teams&amp;limit=50&amp;offset=50</span>
<span class="c1"># &gt;&gt;&gt; foo_services</span>
<span class="c1"># [{&quot;type&quot;: &quot;service&quot; ...}, ... ]</span>
</pre></div>
</div>
</section>
<section id="requests-and-responses">
<h2>Requests and Responses<a class="headerlink" href="#requests-and-responses" title="Link to this heading"></a></h2>
<p>To set the request body in a post or put request, pass as the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword
argument an object that will be JSON-encoded as the body.</p>
<p>To obtain the response from the API, if using plain <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">put</span></code>
or <code class="docutils literal notranslate"><span class="pre">delete</span></code>, use the returned <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object. That object’s
<code class="docutils literal notranslate"><span class="pre">json()</span></code> method will return the result of JSON-decoding the response body (it
will typically of type <code class="docutils literal notranslate"><span class="pre">dict</span></code>). Other metadata such as headers can also be
obtained:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;incidents&#39;</span><span class="p">)</span>
<span class="c1"># The UUID of the API request, which can be supplied to PagerDuty Customer</span>
<span class="c1"># Support in the event of server errors (status 5xx):</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;x-request-id&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If using the <code class="docutils literal notranslate"><span class="pre">j*</span></code> methods, i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.jget</span></code>, the return value
will be the full body of the response from the API after JSON-decoding, and
the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument is not modified.</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods, the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument is modified before
sending to <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a>, if necessary, to encapsulate the body inside an entity
wrapper.  The response is the decoded body after unwrapping, if the API
endpoint returns wrapped entities. For more details, refer to <a class="reference internal" href="#wrapping"><span class="std std-ref">Entity Wrapping</span></a>.</p>
<section id="data-types">
<h3>Data types<a class="headerlink" href="#data-types" title="Link to this heading"></a></h3>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/types">Types</a></p>
<p>Note these analogues in structure between the JSON schema and the object
in Python:</p>
<ul class="simple">
<li><p>If the data type documented in the schema is
“object”, then the corresponding type of the Python object will be <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p></li>
<li><p>If the data type documented in the schema is
“array”, then the corresponding type of the Python object will be <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p></li>
<li><p>Generally speaking, the data type in the decoded object is according to the
design of the <a class="reference external" href="https://docs.python.org/3/library/json.html">json</a> Python library.</p></li>
</ul>
<p>For example, consider the example structure of an escalation policy as given in
the API reference page for <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/escalation_policies/{id}</span></code> (“Get an
escalation policy”). To access the name of the second target in level 1,
assuming the variable <code class="docutils literal notranslate"><span class="pre">ep</span></code> represents the unwrapped escalation policy object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ep</span><span class="p">[</span><span class="s1">&#39;escalation_rules&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;targets&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span>
<span class="c1"># &quot;Daily Engineering Rotation&quot;</span>
</pre></div>
</div>
<p>To add a new level, one would need to create a new escalation rule as a
dictionary object and then append it to the <code class="docutils literal notranslate"><span class="pre">escalation</span> <span class="pre">rules</span></code> property.
Using the example given in the API reference page:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_rule</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;escalation_delay_in_minutes&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PAM4FGS&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user_reference&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PI7DH85&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;schedule_reference&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">ep</span><span class="p">[</span><span class="s1">&#39;escalation_rules&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rule</span><span class="p">)</span>
<span class="c1"># Save changes:</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="n">ep</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="resource-schemas">
<h3>Resource Schemas<a class="headerlink" href="#resource-schemas" title="Link to this heading"></a></h3>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU5-resource-schemas">Resource Schemas</a></p>
<p>The details of any given resource’s schema can be found in the request and
response examples from the <a class="reference external" href="https://developer.pagerduty.com/api-reference/">PagerDuty API Reference</a> pages for the resource’s
respective API, as well as the page documenting the resource type itself.</p>
</section>
</section>
<section id="entity-wrapping">
<span id="wrapping"></span><h2>Entity Wrapping<a class="headerlink" href="#entity-wrapping" title="Link to this heading"></a></h2>
<p>See also: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTYx-wrapped-entities">Wrapped Entities</a>.
Most of PagerDuty’s REST API v2 endpoints respond with their content wrapped
inside of another object with a single key at the root level of the
(JSON-encoded) response body, and/or require the request body be wrapped in
another object that contains a single key. Endpoints with such request/response
schemas usually (with few exceptions) support pagination.</p>
<section id="identifying-wrapped-entity-endpoints">
<h3>Identifying Wrapped-entity Endpoints<a class="headerlink" href="#identifying-wrapped-entity-endpoints" title="Link to this heading"></a></h3>
<p><em>If the endpoint’s response schema or expected request schema contains only one
property that contains all of the content of the API resource, the endpoint is
said to wrap entities.</em> In resource collection endpoints that support
pagination, the response schema contains additional pagination-related
properties such as <code class="docutils literal notranslate"><span class="pre">more</span></code> (for classic pagination) or <code class="docutils literal notranslate"><span class="pre">next_cursor</span></code> (for
cursor-based pagination) and no other content-bearing properties.</p>
</section>
<section id="wrapped-entity-aware-functions">
<h3>Wrapped-entity-aware Functions<a class="headerlink" href="#wrapped-entity-aware-functions" title="Link to this heading"></a></h3>
<p>The following methods will automatically extract and return the wrapped content
of API responses, and wrap request entities for the user as appropriate:</p>
<ul class="simple">
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.dict_all" title="pagerduty.RestApiV2BaseClient.dict_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.dict_all</span></code></a>: Create a dictionary of all results from a resource collection</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.find</span></code>: Find and return a specific result of a resource collection that matches a query</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_all" title="pagerduty.RestApiV2BaseClient.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_all</span></code></a>: Iterate through all results of a resource collection</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_cursor" title="pagerduty.RestApiV2BaseClient.iter_cursor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_cursor</span></code></a>: Iterate through all results of a resource collection using cursor-based pagination</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.list_all" title="pagerduty.RestApiV2BaseClient.list_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.list_all</span></code></a>: Create a list of all results from a resource collection</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.rget" title="pagerduty.RestApiV2BaseClient.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.rget</span></code></a>: Get the wrapped entity or resource collection at a given endpoint</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.rpost" title="pagerduty.RestApiV2BaseClient.rpost"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.rpost</span></code></a>: Send a POST request, wrapping the request entity / unwrapping the response entity</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.rput" title="pagerduty.RestApiV2BaseClient.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.rput</span></code></a>: Send a PUT request, wrapping the request entity / unwrapping the response entity</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.persist</span></code>: Create a resource entity with specified attributes if one that matches them does not already exist</p></li>
</ul>
</section>
<section id="special-cases">
<h3>Special Cases<a class="headerlink" href="#special-cases" title="Link to this heading"></a></h3>
<p>There are some API endpoints that do not follow API schema conventions for
entity wrapping. Some do not wrap entities at all. On all endpoints that do not
wrap entities, the results for a given <code class="docutils literal notranslate"><span class="pre">r*</span></code> method would be the same if using
the equivalent <code class="docutils literal notranslate"><span class="pre">j*</span></code> method, and the details of request and response schemas
are are left to the end user to extract and use as desired. Moreover, on all
endpoints that completely lack entity wrapping, pagination is not supported,
i.e. <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_all" title="pagerduty.RestApiV2BaseClient.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_all</span></code></a> will raise
<a class="reference internal" href="module_reference.html#pagerduty.UrlError" title="pagerduty.UrlError"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.UrlError</span></code></a> if used with them.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<p>The endpoint “Create Business Service Subscribers”, or <code class="docutils literal notranslate"><span class="pre">POST</span>
<span class="pre">/business_services/{id}/subscribers</span></code>, wraps the response differently from the
request. The end user can still pass the content to be wrapped via the <code class="docutils literal notranslate"><span class="pre">json</span></code>
argument without the <code class="docutils literal notranslate"><span class="pre">subscribers</span></code> wrapper, while the return value is the
list representing the content inside of the <code class="docutils literal notranslate"><span class="pre">subscriptions</span></code> wrapper in the
response, and there is no need to hard-code any particular endpoint’s wrapper
name into the usage of the client.</p>
<p>Some endpoints are unusual in that the request must be wrapped but the response
is not wrapped or vice versa, i.e. creating Schedule overrides (<code class="docutils literal notranslate"><span class="pre">POST</span>
<span class="pre">/schedules/{id}/overrides</span></code>) or to create a status update on an incient (<code class="docutils literal notranslate"><span class="pre">POST</span>
<span class="pre">/incidents/{id}/status_updates</span></code>).  In all such cases, the user still does not
need to account for this, as the content will be returned and the request
entity is wrapped as appropriate.</p>
<p>What that looks like, for the “Create one or more overrides” endpoint:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">created_overrides</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rpost</span><span class="p">(</span><span class="s1">&#39;/schedules/PGHI789/overrides&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-01T00:00:00-04:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-02T00:00:00-04:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PEYSGVA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user_reference&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;time_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;UTC&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T00:00:00-04:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-01T00:00:00-04:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PEYSGVF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user_reference&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;time_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;UTC&quot;</span>
    <span class="p">}</span>
<span class="p">])</span>
<span class="c1"># &gt;&gt;&gt; created_overrides</span>
<span class="c1"># [</span>
<span class="c1">#     {&#39;status&#39;: 201, &#39;override&#39;: {...}},</span>
<span class="c1">#     {&#39;status&#39;: 400, &#39;errors&#39;: [&#39;Override must end after its start&#39;], &#39;override&#39;: {...}}</span>
<span class="c1"># ]</span>
</pre></div>
</div>
</section>
</section>
<section id="pagination">
<h2>Pagination<a class="headerlink" href="#pagination" title="Link to this heading"></a></h2>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/pagination">Pagination</a></p>
<p>The method <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_all" title="pagerduty.RestApiV2BaseClient.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_all</span></code></a> returns an iterator that
yields results from an endpoint that features pagination. The methods
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.list_all</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.dict_all</span></code> will request all pages of the
collection and return the results as a list or dictionary, respectively.</p>
<p>When retrieving results from an endpoint that supports cursor-based pagination,
these methods will use <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_cursor" title="pagerduty.RestApiV2BaseClient.iter_cursor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_cursor</span></code></a>
automatically.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: Find all users with &quot;Dav&quot; in their name/email (i.e. Dave/David)</span>
<span class="c1"># in the PagerDuty account:</span>
<span class="k">for</span> <span class="n">dave</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span><span class="s2">&quot;Dav&quot;</span><span class="p">}):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">dave</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">dave</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]))</span>

<span class="c1"># Example: Get a dictionary of all users, keyed by email, and use it to</span>
<span class="c1"># find the ID of the user whose email is ``bob@example.com``</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dict_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="s1">&#39;bob@example.com&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

<span class="c1"># Same as above, but using ``find``:</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;bob@example.com&#39;</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>By default, classic, a.k.a. numeric pagination, will be used. If the endpoint
supports cursor-based pagination, it will call out to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.iter_cursor</span></code> to iterate through results
instead.</p>
<section id="retrieving-large-historical-datasets">
<h3>Retrieving Large Historical Datasets<a class="headerlink" href="#retrieving-large-historical-datasets" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU4-pagination#classic-pagination">Classic pagination</a>
in REST API v2 has a hard limit of 10,000 records (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.rest_api_v2_client.ITERATION_LIMIT</span></code>). In other words, if the sum of the <code class="docutils literal notranslate"><span class="pre">limit</span></code>
and <code class="docutils literal notranslate"><span class="pre">offset</span></code> parameters is larger than this value, the API will respond with
HTTP 400 Invalid Request. To get around this issue and retrieve larger data
sets, one must either filter the results such that the total is less than this
hard limit, or break the data set down into smaller time windows using the
<code class="docutils literal notranslate"><span class="pre">since</span></code> and <code class="docutils literal notranslate"><span class="pre">until</span></code> parameters, for APIs that support them.</p>
<p>The method <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.iter_history" title="pagerduty.RestApiV2Client.iter_history"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.iter_history</span></code></a> automatically
performs the second of these techniques to provide an iterator, similar to
<a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_all" title="pagerduty.RestApiV2BaseClient.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_all</span></code></a>, but that has practically no
dataset size limit. To use it, first construct timezone-aware
<code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> objects (see: <a class="reference external" href="https://docs.python.org/3/library/datetime.html">datetime</a>) that correspond to the
absolute beginning and end of the time interval from which to retrieive
records. Pass these objects as the second and third positional arguments to
<a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.iter_history" title="pagerduty.RestApiV2Client.iter_history"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.iter_history</span></code></a>.</p>
<p>For example, to obtain all log entries (incident/alert timeline events) year-to-date:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<span class="n">until</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="n">since</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">until</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="c1"># Assume &quot;client&quot; is an instance of RestApiV2Client and &quot;process_ile&quot; is a</span>
<span class="c1"># storage and/or data reduction/aggregation method:</span>
<span class="k">for</span> <span class="n">log_entry</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">iter_history</span><span class="p">(</span><span class="s1">&#39;/log_entries&#39;</span><span class="p">,</span> <span class="n">since</span><span class="p">,</span>  <span class="n">until</span><span class="p">):</span>
    <span class="n">process_ile</span><span class="p">(</span><span class="n">log_entry</span><span class="p">)</span>
</pre></div>
</div>
<p>It is recommended to perform action on each item once it has been yielded, i.e.
persist it to a cache, rather than constructing big a list of results in-memory
and then operating on the list. That is because, if anything goes wrong while
fetching the dataset, i.e. an exception is raised or the program runs out of
memory, the partial data it retrieved will be lost to garbage collection.</p>
</section>
<section id="non-standard-pagination-styles">
<h3>Non-Standard Pagination Styles<a class="headerlink" href="#non-standard-pagination-styles" title="Link to this heading"></a></h3>
<p>For all endpoints that implement one of the standard pagination styles (classic
or cursor-based), <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2BaseClient.iter_all" title="pagerduty.RestApiV2BaseClient.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2BaseClient.iter_all</span></code></a> will work. If
the endpoint does not completely or correctly implement one of these styles of
pagination, the pagination methods (i.e.  <code class="docutils literal notranslate"><span class="pre">iter_all</span></code>/<code class="docutils literal notranslate"><span class="pre">list_all</span></code>) cannot be
used with them. For example:</p>
<p>As of this writing, there are two API endpoints known to have a their own special
pagination style, and specialized methods have been added for them. They are
as follows:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.pagerduty.com/api-reference/c2d493e995071-get-raw-data-multiple-incidents">Get raw data - multiple incidents (analytics)</a> / <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/analytics/raw/incidents</span></code>: <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.iter_analytics_raw_incidents" title="pagerduty.RestApiV2Client.iter_analytics_raw_incidents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.iter_analytics_raw_incidents</span></code></a></p></li>
<li><p><a class="reference external" href="https://developer.pagerduty.com/api-reference/b9fe211cc2748-list-alert-grouping-settings">List alert grouping settings</a> / <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/alert_grouping_settings</span></code>: <a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.iter_alert_grouping_settings" title="pagerduty.RestApiV2Client.iter_alert_grouping_settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.iter_alert_grouping_settings</span></code></a></p></li>
</ul>
<p>These methods must be used on said endpoints; using the standard pagination
methods such as <code class="docutils literal notranslate"><span class="pre">iter_all</span></code>, <code class="docutils literal notranslate"><span class="pre">iter_cursor</span></code> or <code class="docutils literal notranslate"><span class="pre">iter_history</span></code> on them will
not work properly.</p>
</section>
<section id="performance-and-completeness-of-results">
<h3>Performance and Completeness of Results<a class="headerlink" href="#performance-and-completeness-of-results" title="Link to this heading"></a></h3>
<p>Because HTTP requests are made synchronously and not in multiple threads,
requesting all pages of data will happen one page at a time and the functions
<code class="docutils literal notranslate"><span class="pre">list_all</span></code> and <code class="docutils literal notranslate"><span class="pre">dict_all</span></code> will not return until after the final HTTP
response. Simply put, the functions will take longer to return if the total
number of results is higher.</p>
<p>Moreover, if these methods are used to fetch a very large volume of data, and
an error is encountered when this happens, the partial data set will be
discarded when the exception is raised. To make use of partial results, perform
actions on each result using an <code class="docutils literal notranslate"><span class="pre">iter_*</span></code> method and catch/handle exceptions
as desired.</p>
</section>
<section id="updating-creating-or-deleting-while-paginating">
<h3>Updating, creating or deleting while paginating<a class="headerlink" href="#updating-creating-or-deleting-while-paginating" title="Link to this heading"></a></h3>
<p>If performing page-wise write operations, i.e. making persistent changes to the
PagerDuty application state immediately after fetching each page of results, an
erroneous condition can result if there is any change to the resources in the
result set that would affect their presence or position in the set. For
example, creating objects, deleting them, or changing the attribute being used
for sorting or filtering.</p>
<p>This is because the contents are updated in real time, and pagination contents
are recalculated based on the state of the PagerDuty application at the time of
each request for a page of results. Therefore, records may be skipped or
repeated in results if the state changes, because the content of any given page
will change accordingly. Note also that changes made from other processes,
including manual edits through the PagerDuty web application, can have the same
effect.</p>
<p>To elaborate: let’s say that each resource object in the full list is a page in
a notebook. Classic pagination with <code class="docutils literal notranslate"><span class="pre">limit=100</span></code> is essentially “go through
100 pages, then repeat starting with the 101st page, then with the 201st, etc.”
Deleting records in-between these 100-at-a-time pagination requests would be
like tearing out pages after reading them. At the time of the second page
request, what was originally the 101st page before starting will shift to
become the first page after tearing out the first hundred pages. Thus, when
going to the 101st page after finishing tearing out the first hundred pages,
the second hundred pages will be skipped over, and similarly for pages 401-500,
601-700 and so on. If attaching pages, the opposite happens: some results will be
returned more than once, because they get bumped to the next group of 100 pages.</p>
</section>
</section>
<section id="multi-updating">
<h2>Multi-updating<a class="headerlink" href="#multi-updating" title="Link to this heading"></a></h2>
<p>Multi-update actions can be performed using <code class="docutils literal notranslate"><span class="pre">rput</span></code> with some endpoints. For
instance, to resolve two incidents with IDs <code class="docutils literal notranslate"><span class="pre">PABC123</span></code> and <code class="docutils literal notranslate"><span class="pre">PDEF456</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span>
    <span class="s2">&quot;incidents&quot;</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PABC123&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PDEF456&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">},</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this way, a single API request can more efficiently perform multiple update
actions.</p>
<p>It is important to note, however, that updating incidents requires using a
user-scoped access token or setting the <code class="docutils literal notranslate"><span class="pre">From</span></code> header to the login email
address of a valid PagerDuty user. To set this, pass it through using the
<code class="docutils literal notranslate"><span class="pre">headers</span></code> keyword argument, or set the
<a class="reference internal" href="module_reference.html#pagerduty.RestApiV2Client.default_from" title="pagerduty.RestApiV2Client.default_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.default_from</span></code></a> property, or pass the email
address as the <code class="docutils literal notranslate"><span class="pre">default_from</span></code> keyword argument when constructing the client
initially.</p>
</section>
<section id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="module_reference.html#pagerduty.UrlError" title="pagerduty.UrlError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.UrlError</span></code></a> is raised prior to making API calls, and it indicates
unsupported URLs and/or malformed input.</p>
<p>The base exception class for all errors encountered when making requests is
<a class="reference internal" href="module_reference.html#pagerduty.Error" title="pagerduty.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.Error</span></code></a>. This includes network / transport issues where there
is no response from the API, in which case the exception will inherit from the
exception raised by the underlying HTTP library.</p>
<p>All errors that involve a response from the API are instances of
<a class="reference internal" href="module_reference.html#pagerduty.HttpError" title="pagerduty.HttpError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.HttpError</span></code></a> and will have a <code class="docutils literal notranslate"><span class="pre">response</span></code> property containing
the <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object. Its subclass
<code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.HttpServerError</span></code> is used for special cases when the API is
responding in an unexpected way.</p>
<p>One can thus define specialized error handling logic in which the REST API
response data (i.e.  headers, code and body) are available in the catching
scope. For example, the following code prints “User not found” in the event of a 404,
prints out the user’s email if the user exists and raises the underlying
exception if it’s any other HTTP error code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s2">&quot;/users/PJKL678&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>

<span class="k">except</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">HttpError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User not found&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</pre></div>
</div>
</section>
<section id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h2>
<p>When a client object is instantiated, a
<a class="reference external" href="https://docs.python.org/3/library/logging.html#logger-objects">Logger object</a>
is created as follows:</p>
<ul class="simple">
<li><p>Its level is unconfigured (<code class="docutils literal notranslate"><span class="pre">logging.NOTSET</span></code>) which causes it to defer to the
level of the parent logger. The parent is the root logger unless specified
otherwise (see <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging-levels">Logging Levels</a>).</p></li>
<li><p>The logger is initially not configured with any handlers. Configuring
handlers is left to the discretion of the user (see <a class="reference external" href="https://docs.python.org/3/library/logging.handlers.html">logging.handlers</a>)</p></li>
<li><p>The logger can be accessed and set through the property
<a class="reference internal" href="module_reference.html#pagerduty.ApiClient.log" title="pagerduty.ApiClient.log"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.log</span></code></a>.</p></li>
</ul>
<p>The attribute <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.print_debug" title="pagerduty.ApiClient.print_debug"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.print_debug</span></code></a> enables sending
debug-level log messages from the client to command line output. It is used as
follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method 1: keyword argument, when constructing a new client:</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">pagerduty</span><span class="o">.</span><span class="n">RestApiV2Client</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Method 2: on an existing client, by setting the property:</span>
<span class="n">client</span><span class="o">.</span><span class="n">print_debug</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># to disable:</span>
<span class="n">client</span><span class="o">.</span><span class="n">print_debug</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>What this does is assign a <a class="reference external" href="https://docs.python.org/3/library/logging.handlers.html#streamhandler">logging.StreamHandler</a>
directly to the client’s logger and set the log level to <code class="docutils literal notranslate"><span class="pre">logging.DEBUG</span></code>.
All log messages are then sent directly to <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>. The default value
for all clients is <code class="docutils literal notranslate"><span class="pre">False</span></code>, and it is recommended to keep it that way in
production systems.</p>
</section>
<section id="using-a-proxy-server">
<h2>Using a Proxy Server<a class="headerlink" href="#using-a-proxy-server" title="Link to this heading"></a></h2>
<p>To configure the client to use a host as a proxy for HTTPS traffic, update the
<code class="docutils literal notranslate"><span class="pre">proxies</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Host 10.42.187.3 port 4012 protocol https:</span>
<span class="n">client</span><span class="o">.</span><span class="n">proxies</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="s1">&#39;10.42.187.3:4012&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="http-retry-configuration">
<h2>HTTP Retry Configuration<a class="headerlink" href="#http-retry-configuration" title="Link to this heading"></a></h2>
<p>Session objects support retrying API requests if they receive a non-success
response or if they encounter a network error.</p>
<p>This behavior is configurable through the following properties:</p>
<ul class="simple">
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.retry" title="pagerduty.ApiClient.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.retry</span></code></a>: a dictionary that allows defining per-HTTP-status retry limits</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.max_http_attempts" title="pagerduty.ApiClient.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.max_http_attempts</span></code></a>: The maximum total number of unsuccessful requests to make in the retry loop of <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.request" title="pagerduty.ApiClient.request"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.request</span></code></a> before returning</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.max_network_attempts" title="pagerduty.ApiClient.max_network_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.max_network_attempts</span></code></a>: The maximum number of retries that will be attempted in the case of network or non-HTTP error</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.sleep_timer" title="pagerduty.ApiClient.sleep_timer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.sleep_timer</span></code></a>: The initial cooldown factor</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.sleep_timer_base" title="pagerduty.ApiClient.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.sleep_timer_base</span></code></a>: Factor by which the cooldown time is increased after each unsuccessful attempt</p></li>
<li><p><a class="reference internal" href="module_reference.html#pagerduty.ApiClient.stagger_cooldown" title="pagerduty.ApiClient.stagger_cooldown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.stagger_cooldown</span></code></a>: Randomizing factor for increasing successive cooldown wait times</p></li>
</ul>
<section id="default-behavior">
<h3>Default Behavior<a class="headerlink" href="#default-behavior" title="Link to this heading"></a></h3>
<p>By default, after receiving a status 429 response, clients will retry an
unlimited number of times, increasing the wait time before retry each
successive time.  When encountering status <code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code>, the client
will immediately raise <a class="reference internal" href="module_reference.html#pagerduty.HttpError" title="pagerduty.HttpError"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.HttpError</span></code></a>; this is a non-transient error
caused by an invalid credential.</p>
<p>For all other success or error statuses, the underlying request method in the
client will return the <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object.</p>
</section>
<section id="exponential-cooldown">
<h3>Exponential Cooldown<a class="headerlink" href="#exponential-cooldown" title="Link to this heading"></a></h3>
<p>After each unsuccessful attempt, the client will sleep for a short period that
increases exponentially with each retry.</p>
<p>Let:</p>
<ul class="simple">
<li><p>a = <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.sleep_timer_base" title="pagerduty.ApiClient.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.sleep_timer_base</span></code></a> (base of the exponent, default value <code class="docutils literal notranslate"><span class="pre">2</span></code>)</p></li>
<li><p>t<sub>0</sub> = <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.sleep_timer" title="pagerduty.ApiClient.sleep_timer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.sleep_timer</span></code></a> (initial sleep timer, default value <code class="docutils literal notranslate"><span class="pre">1.5</span></code>)</p></li>
<li><p>t<sub>n</sub> = Sleep time after n attempts</p></li>
<li><p>ρ = <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.stagger_cooldown" title="pagerduty.ApiClient.stagger_cooldown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.stagger_cooldown</span></code></a></p></li>
<li><p>r<sub>n</sub> = a randomly-generated real number between 0 and 1, distinct for each n-th request</p></li>
</ul>
<p>Assuming ρ = 0 (the default value):</p>
<p>t<sub>n</sub> = t<sub>0</sub> a<sup>n</sup></p>
<p>If ρ is nonzero:</p>
<p>t<sub>n</sub> = a (1 + ρ r<sub>n</sub>) t<sub>n-1</sub></p>
</section>
<section id="configuring-retry-behavior">
<h3>Configuring Retry Behavior<a class="headerlink" href="#configuring-retry-behavior" title="Link to this heading"></a></h3>
<p>The dictionary property <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.retry" title="pagerduty.ApiClient.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.retry</span></code></a> allows customization of
HTTP retry limits on a per-HTTP-status basis. This includes the ability to
override the above defaults for 401 and 429, although that is not recommended.</p>
<p>Each key in the dictionary represents a HTTP status, and its associated value
the number of times that the client will retry the request if it receives
that status. <strong>Success statuses (2xx) will be ignored.</strong></p>
<p>If a different error status is encountered on a retry, it won’t count towards
the limit of the first status, but will be counted separately. However, the
total overall number of attempts that will be made to get a success status is
limited by <a class="reference internal" href="module_reference.html#pagerduty.ApiClient.max_http_attempts" title="pagerduty.ApiClient.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.max_http_attempts</span></code></a>. This will always
supersede the maximum number of retries for any status defined in
<a class="reference internal" href="module_reference.html#pagerduty.ApiClient.retry" title="pagerduty.ApiClient.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.ApiClient.retry</span></code></a> if it is lower.</p>
<p>Low-level HTTP request functions in client classes, i.e. <code class="docutils literal notranslate"><span class="pre">get</span></code>, will return
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> objects when they run out of retries. Higher-level
functions that require a success status response, i.e.
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.RestApiV2Client.list_all</span></code> and
<a class="reference internal" href="module_reference.html#pagerduty.EventsApiV2Client.trigger" title="pagerduty.EventsApiV2Client.trigger"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pagerduty.EventsApiV2Client.trigger</span></code></a>, will raise instances of
<a class="reference internal" href="module_reference.html#pagerduty.HttpError" title="pagerduty.HttpError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pagerduty.HttpError</span></code></a>, but only after the configured retry limits are
reached in the underlying HTTP request methods.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will take about 30 seconds plus API request time, carrying out four</span>
<span class="c1"># attempts with 2, 4, 8 and 16 second pauses between them, before finally</span>
<span class="c1"># returning the status 404 response object for the user that doesn&#39;t exist:</span>
<span class="n">client</span><span class="o">.</span><span class="n">max_http_attempts</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># lower value takes effect</span>
<span class="n">client</span><span class="o">.</span><span class="n">retry</span><span class="p">[</span><span class="mi">404</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># this won&#39;t take effect</span>
<span class="n">client</span><span class="o">.</span><span class="n">sleep_timer</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">client</span><span class="o">.</span><span class="n">sleep_timer_base</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PNOEXST&#39;</span><span class="p">)</span>

<span class="c1"># Same as the above, but with the per-status limit taking precedence, so</span>
<span class="c1"># the total wait time is 62 seconds:</span>
<span class="n">client</span><span class="o">.</span><span class="n">max_http_attempts</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PNOEXST&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="changelog.html" class="btn btn-neutral float-left" title="Changelog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pdpyras_migration_guide.html" class="btn btn-neutral float-right" title="PDPYRAS Migration Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 PagerDuty, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>